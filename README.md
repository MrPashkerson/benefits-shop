# Программное средство управления гибкими льготами и магазином бенефитов

Гибкие льготы, или так называемый «кафетерий льгот», становятся все более популярными среди ИТ-компаний на рынке СНГ. Эта система позволяет сотрудникам выбирать наиболее подходящие для них льготы из предложенного списка, что не только повышает их удовлетворенность и лояльность, но и способствует снижению административных расходов на невостребованные бенефиты.

## Руководство по установке и развёртыванию программного средства

Для работы программного средства требуется следующее программное обеспечение:
* любой менеджер пакетов JavaScript (Yarn, NPM или pnpm);
* Node.js версии 16+;
* база данных MongoDB.

Настройка конфигурационного файла:
* откройте командную строку и перейдите в корневую папку программного средства;
* в командной строке пропишите команду cd benefits-shop && cp .env.example .env для копирования переменных окружения из примера;

В корневой папке программного средства появится файл .env. Откройте его с помощью любого текстового редактора или IDE. В нём будет список переменных, которые необходимо заполнить. Разберём каждую переменную отдельно:
1. `PORT=3000` – определяет порт, на котором будет запущен сервер. По умолчанию значение 3000.
2. `DATABASE_URI=mongodb://127.0.0.1/example-link` – строка подключения к базе данных MongoDB. Здесь нельзя оставить значение по умолчанию, его необходимо обязательно указать.
3. `PAYLOAD_SECRET=YOUR_SECRET_HERE` – используется для шифрования JWT токенов. YOUR_SECRET_HERE замените на секретную фразу, которая будет использоваться для шифрования.
4. `PAYLOAD_PUBLIC_SERVER_URL=http://localhost:3000` – URL, где располагается сервер. Необходимо указать значение для корректной работы CMS.
5. `NEXT_PUBLIC_SERVER_URL=http://localhost:3000` – URL, где располагается сервер. Необходимо указать значение для корректной работы клиентской части программного средства.
6. `PAYLOAD_PUBLIC_DRAFT_SECRET=demo-draft-secret` – используется для предварительного просмотра черновиков. demo-draft-secret секретная фра-за для доступа к черновикам.
7. `NEXT_PRIVATE_DRAFT_SECRET=demo-draft-secret` – используется для предварительного просмотра черновиков. Секретная фраза (в данном случае – demo-draft-secret) должна совпадать с предыдущей переменной.
8. `REVALIDATION_KEY=demo-revalation-key` – используется для повторной валидации статических страниц. demo-revalation-key ключ для повторной валидации.
9. `NEXT_PRIVATE_REVALIDATION_KEY=demo-revalation-key` – используется для повторной валидации статических страниц. Секретная фраза (в данном случае – demo-revalation-key) должна совпадать с предыдущей переменной.
10. `SMTP_SERVICE=“Gmail”` – сервис, используемый для отправки электронных писем. Gmail указывает на использование сервиса Gmail.
11. `SMTP_HOST=“smtp.gmail.com”` – SMTP-хост для сервиса отправки писем. smtp.gmail.com адрес SMTP-хоста для Gmail.
12. `SMTP_PORT=465` – порт для SMTP-сервера. 465 стандартный порт для Gmail.
13. `SMTP_USER=“username”` – пользователь для SMTP-аутентификации.
14. `SMTP_PASS=“pass”` – пароль для SMTP-аутентификации.
15. `CREDIT_USERS_TIME=“0 3 1 * *”` – время для выполнения запланированных задач по начислению кредитов пользователям. По умолчанию: 03:00 1 числа каждого месяца. Внутри файла .env есть инструкция как установить необходимое время для выполнения.
16. `RESET_USER_CREDITS_TIME=“0 0 1 1 *”` – время для выполнения запланированных задач по сбросу кредитов пользователей. По умолчанию: 01:00 1 января каждого года. Внутри файла .env есть инструкция как установить необходимое время для выполнения.

После настройки конфигурационного файла вернитесь в командную строку в корневой папке программного средства. Вызовите скрипт сборки, запустив yarn build или npm run build в корне проекта. Это создаст каталог ./build с готовым к деплою набором файлов. Затем, пропишите yarn serve или npm run serve, чтобы запустить Node в производство.

Для окончания настройки программного средства необходимо произвести первоначальную настройку БД. Для этого перейдите по URL, на котором задеплоино программное средство, с добавлением /admin (долж-но получиться, например, https://your-domain.com/admin). Зарегистрируйте первого пользователя, указав ему роль администратора. После этого откроется панель управления и начнётся настройка.

После завершения настройки программное средство считается полностью развёрнутым.

[Видео-демонстрация работы программного средства](https://youtu.be/yL64fBS5NaE)

Больше информации:

![more-info.svg](more-info.svg)

https://drive.google.com/file/d/1C_QG8mEXHG1TEiS5ZUMIse4Xrq-aAFPk/view?usp=drivesdk